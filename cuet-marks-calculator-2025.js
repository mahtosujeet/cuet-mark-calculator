// Answer key data for CUET questions
const ansKey = {
  "questions": [
    {
      "question_id": "1780701592",
      "correct_option": 2
    },
    {
      "question_id": "1780701601",
      "correct_option": 2
    },
    {
      "question_id": "1780701602",
      "correct_option": 2
    },
    {
      "question_id": "1780701603",
      "correct_option": 4
    },
    {
      "question_id": "1780701604",
      "correct_option": 1
    },
    {
      "question_id": "1780701605",
      "correct_option": 3
    },
    {
      "question_id": "1780701606",
      "correct_option": 1
    },
    {
      "question_id": "1780701607",
      "correct_option": 1
    },
    {
      "question_id": "1780701608",
      "correct_option": 1
    },
    {
      "question_id": "1780701609",
      "correct_option": 1
    },
    {
      "question_id": "1780701610",
      "correct_option": 4
    },
    {
      "question_id": "1780701593",
      "correct_option": 1
    },
    {
      "question_id": "1780701611",
      "correct_option": 4
    },
    {
      "question_id": "1780701612",
      "correct_option": 1
    },
    {
      "question_id": "1780701613",
      "correct_option": 1
    },
    {
      "question_id": "1780701614",
      "correct_option": 3
    },
    {
      "question_id": "1780701615",
      "correct_option": 1
    },
    {
      "question_id": "1780701616",
      "correct_option": 4
    },
    {
      "question_id": "1780701617",
      "correct_option": 2
    },
    {
      "question_id": "1780701618",
      "correct_option": 4
    },
    {
      "question_id": "1780701619",
      "correct_option": 2
    },
    {
      "question_id": "1780701620",
      "correct_option": 1
    },
    {
      "question_id": "1780701594",
      "correct_option": 4
    },
    {
      "question_id": "1780701621",
      "correct_option": 3
    },
    {
      "question_id": "1780701622",
      "correct_option": 3
    },
    {
      "question_id": "1780701623",
      "correct_option": 1
    },
    {
      "question_id": "1780701624",
      "correct_option": 3
    },
    {
      "question_id": "1780701625",
      "correct_option": 1
    },
    {
      "question_id": "1780701626",
      "correct_option": 3
    },
    {
      "question_id": "1780701627",
      "correct_option": 4
    },
    {
      "question_id": "1780701628",
      "correct_option": 2
    },
    {
      "question_id": "1780701629",
      "correct_option": 1
    },
    {
      "question_id": "1780701630",
      "correct_option": 2
    },
    {
      "question_id": "1780701595",
      "correct_option": 1
    },
    {
      "question_id": "1780701631",
      "correct_option": 2
    },
    {
      "question_id": "1780701632",
      "correct_option": 1
    },
    {
      "question_id": "1780701633",
      "correct_option": 4
    },
    {
      "question_id": "1780701634",
      "correct_option": 1
    },
    {
      "question_id": "1780701635",
      "correct_option": 3
    },
    {
      "question_id": "1780701636",
      "correct_option": 3
    },
    {
      "question_id": "1780701637",
      "correct_option": 2
    },
    {
      "question_id": "1780701638",
      "correct_option": 4
    },
    {
      "question_id": "1780701639",
      "correct_option": 3
    },
    {
      "question_id": "1780701640",
      "correct_option": 1
    },
    {
      "question_id": "1780701596",
      "correct_option": 3
    },
    {
      "question_id": "1780701641",
      "correct_option": 3
    },
    {
      "question_id": "1780701642",
      "correct_option": 1
    },
    {
      "question_id": "1780701643",
      "correct_option": 3
    },
    {
      "question_id": "1780701644",
      "correct_option": 1
    },
    {
      "question_id": "1780701645",
      "correct_option": 2
    },
    {
      "question_id": "1780701646",
      "correct_option": 2
    },
    {
      "question_id": "1780701647",
      "correct_option": 2
    },
    {
      "question_id": "1780701648",
      "correct_option": 2
    },
    {
      "question_id": "1780701649",
      "correct_option": 3
    },
    {
      "question_id": "1780701650",
      "correct_option": 4
    },
    {
      "question_id": "1780701597",
      "correct_option": 1
    },
    {
      "question_id": "1780701651",
      "correct_option": 1
    },
    {
      "question_id": "1780701652",
      "correct_option": 1
    },
    {
      "question_id": "1780701653",
      "correct_option": 2
    },
    {
      "question_id": "1780701654",
      "correct_option": 2
    },
    {
      "question_id": "1780701655",
      "correct_option": 4
    },
    {
      "question_id": "1780701656",
      "correct_option": 2
    },
    {
      "question_id": "1780701657",
      "correct_option": 3
    },
    {
      "question_id": "1780701658",
      "correct_option": 2
    },
    {
      "question_id": "1780701659",
      "correct_option": 1
    },
    {
      "question_id": "1780701660",
      "correct_option": 2
    },
    {
      "question_id": "1780701598",
      "correct_option": 3
    },
    {
      "question_id": "1780701661",
      "correct_option": 1
    },
    {
      "question_id": "1780701662",
      "correct_option": 2
    },
    {
      "question_id": "1780701663",
      "correct_option": 3
    },
    {
      "question_id": "1780701664",
      "correct_option": 2
    },
    {
      "question_id": "1780701665",
      "correct_option": 2
    },
    {
      "question_id": "1780701666",
      "correct_option": 2
    },
    {
      "question_id": "1780701599",
      "correct_option": 2
    },
    {
      "question_id": "1780701600",
      "correct_option": 4
    }
  ]
};

// Calculate scores
const q = document.querySelectorAll(".question-pnl");
let totalMark = 0;
let correct = 0;
let incorrect = 0;

q.forEach((quesEle) => {
  const quesId = quesEle.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0].childNodes[1].childNodes[1].outerText.trim();
  const markedAns = quesEle.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0].childNodes[7].childNodes[1].childNodes[0].nodeValue.trim();
  const correctAns = ansKey.questions.find((ele) => ele.question_id === quesId)?.correct_option;
  
  if (!correctAns) {
    console.warn(`Answer not found for question ID: ${quesId}`);
    return;
  }
  
  if (markedAns === "--") {
    return;
  }
  
  if (parseInt(markedAns) === correctAns) {
    totalMark += 4;
    correct += 1;
  } else {
    totalMark -= 1;
    incorrect += 1;
  }
});

// Print results
console.log("Total Marks: ", totalMark);
console.log("Correct: ", correct);
console.log("Incorrect: ", incorrect);
console.log("Attempted: ", correct + incorrect);
console.log("Unattempted: ", q.length - (correct + incorrect));

// Display results directly on the page if possible
try {
  const resultDiv = document.createElement('div');
  resultDiv.style.cssText = 'position: fixed; top: 10px; right: 10px; background: #4CAF50; color: white; padding: 15px; border-radius: 5px; z-index: 9999; font-size: 16px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);';
  resultDiv.innerHTML = `
    <h3 style="margin: 0 0 10px 0; border-bottom: 1px solid white; padding-bottom: 5px;">CUET Score Calculator</h3>
    <p><strong>Total Marks:</strong> ${totalMark}</p>
    <p><strong>Correct:</strong> ${correct}</p>
    <p><strong>Incorrect:</strong> ${incorrect}</p>
    <p><strong>Attempted:</strong> ${correct + incorrect}</p>
    <p><strong>Unattempted:</strong> ${q.length - (correct + incorrect)}</p>
  `;
  document.body.appendChild(resultDiv);
} catch (e) {
  // If unable to add to page, just log to console
  console.log("Unable to display results on page:", e);
}